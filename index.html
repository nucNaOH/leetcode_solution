<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>leetcode solution</title>
    <link rel="stylesheet" href="assets/css/style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/solarized-light.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/javascript.min.js"></script> -->
</head>

<body>
    <header>
        <div class="container">
            <div class="home">
                <img class="home-icon" src="assets/img/fav.ico" alt="fav">
                <span class="home-title">LeetCode Solutions</span>
            </div>
            <div class="nav">
                <ul>
                    <li class="nav-item">Problems</li>
                    <li class="nav-item">Tags</li>
                    <li class="nav-item"></li>
                </ul>
            </div>
        </div>
    </header>
    <div class="container">
        <div id="notice">
            <h3>My personal LeetCode Solution with JavaScript.</h3>
            <h4>Solved:
                <span id="solved">12</span>/
                Total:
                <span id="total">433</span>
            </h4>
            <p>Notice: This github pages is still developing in progress. If you are looking for my solutions, please move to <a href="https://github.com/ssdna/leetcode_solution">this github repository</a>.</p>
        </div>
        <div class="content-container">
            <table id="problem-table" border="1">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Status</th>
                        <th>Title</th>
                        <th>Solution</th>
                        <th>Difficulty</th>
                        <th>Tags</th>
                    </tr>
                </thead>
                <tbody>
                    
                </tbody>
            </table>
        </div>
        <div class="dialog" id="problem-solution">
            <pre><code id="code-block" class="javascript"></code></pre>
            <div id="solution-think"></div>
        </div>
        <footer>Copyright &copy DNA </footer>

    </div>
    <script>
        let problems = [];
        // highlight
        hljs.initHighlightingOnLoad();
        // fetch
        // fetch('./001/index.js')
        //     .then(response => response.text())
        //     .then(text => {
        //         const codeBlock = document.getElementById('main')
        //         codeBlock.innerHTML = text;
        //         return codeBlock;
        //     })
        //     .then((ele) => hljs.highlightBlock(ele))

        function getProblems () {
            return fetch('./assets/json/problems.json')
                .then(response => response.json())
                .then(json => {
                    problems = json;
                    displayProblems(problems);
                })
                .then(() => {
                    addEvent()
                })
                .catch(err => {
                    console.error(err);
                })
        }
        function displayProblems (problems) {
            const tbody = document.querySelector('#problem-table tbody');
            problems.forEach(function(p) {
                const tr = document.createElement('tr');
                // num
                let td 
                td = document.createElement('td');
                td.textContent = p.num;
                tr.appendChild(td);
                // status
                td = document.createElement('td');
                td.textContent = p.status;
                tr.appendChild(td);
                // title
                td = document.createElement('td');
                td.textContent = p.title;
                tr.appendChild(td);
                // solution 
                td = document.createElement('td');
                const a = document.createElement('a');
                // a.href = 'javascript:void(0)';
                a.href = '#';
                a.className = 'dialog-trigger';
                a.textContent = 'click';
                a.title = p.num;
                td.appendChild(a);
                tr.appendChild(td);
                // difficulty
                td = document.createElement('td');
                const span = document.createElement('span');
                switch (p.difficulty) {
                    case 'Hard':
                        span.className = 'label label-hard';
                        break;
                    case 'Medium':
                        span.className = 'label label-medium';
                        break;
                    case 'Easy':
                        span.className = 'label label-easy';
                        break;
                    default:
                        break;
                }
                span.textContent = p.difficulty;
                td.appendChild(span);
                tr.appendChild(td);
                // tags
                td = document.createElement('td');
                td.textContent = p.tags;
                tr.appendChild(td);
                
                tbody.appendChild(tr);
            });
        }
        getProblems();

        function addEvent () {
            document.addEventListener('click', (e) => {
                document.querySelector('.dialog').style.display = 'none';
            })
            // show solution
            document.querySelectorAll('.dialog-trigger').forEach((d, i) => {
                d.addEventListener('click', (e) => {
                    e.preventDefault();
                    let num = e.target.title;
                    while (num.length !== 3) {
                        num = '0' + num;
                    }
                    // fetch code
                    Promise.all([ getThink(num), getCode(num)])
                        .then((response) => {
                            const codeBlock = document.querySelector('#code-block')
                            const content = '解题思路：\n' + response.join('\n\n通过代码：\n');
                            codeBlock.innerHTML = 
                            hljs.highlightBlock(codeBlock)
                            document.querySelector('.dialog').style.display = 'block';
                        })
                        .catch(err => {
                            console.error(err);
                        })
                    return false;
                })
            })
        }

        function getCode (num) {
            return fetch(`./${num}/index.js`)
                .then(response => response.text())
        }

        function getThink (num) {
            return fetch(`./${num}/README.md`)
                .then(response => response.text())
        }
        
    </script>
</body>

</html>